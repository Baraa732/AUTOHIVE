# Feature development workflow

---

## Workflow Steps

### [x] Step: Requirements

Your job is to generate a Product Requirements Document based on the feature description,

First, analyze the provided feature definition and determine unclear aspects. For unclear aspects: - Make informed guesses based on context and industry standards - Only mark with [NEEDS CLARIFICATION: specific question] if: - The choice significantly impacts feature scope or user experience - Multiple reasonable interpretations exist with different implications - No reasonable default exists - Prioritize clarifications by impact: scope > security/privacy > user experience > technical details

Ask up to 5 most priority clarifications to the user. Then, create the document following this template:

```
# Feature Specification: [FEATURE NAME]


## User Stories*


### User Story 1 - [Brief Title]

**Acceptance Scenarios**:

1. **Given** [initial state], **When** [action], **Then** [expected outcome]
2. **Given** [initial state], **When** [action], **Then** [expected outcome]

---

## Requirements*

## Success Criteria*

```

Save the PRD into `c:\Users\Al Baraa\Desktop\Github Project\AUTOHIVE\.zencoder\chats\31954dcd-8b42-46b5-ba00-fe700c1e66f8/requirements.md`.

### [x] Step: Technical Specification

Based on the PRD in `c:\Users\Al Baraa\Desktop\Github Project\AUTOHIVE\.zencoder\chats\31954dcd-8b42-46b5-ba00-fe700c1e66f8/requirements.md`, create a detailed technical specification to be used by a coding agent to implement the feature. Follow this template:

```
# Technical Specification: [FEATURE]

## Technical Context
Language/Version, primary dependencies, etc

## Technical Implementation Brief

Summarize key technical decisions for implementing the feature. Make sure they take into account the existing code as much as possible.

## Source Code Structure

## Contracts

Define addition or changes in data models, DB schemas, APIs, code interfaces etc

## Delivery Phases

Define several incremental deliverables for the feature. Each should be a minimal viable product testable end-to-end.

## Verification Strategy

Define how the coding agent can verify each deliverable it creates. Provide instructions for the agent to perform the verification using available tools (lint/test commands, bash commands) and create helper scripts and tools for more complex result verification.
The verification for each deliverable should be executable by a coding agent using built-in capabilities (lint and test commands from the project, bash commands), pre-generated helper scripts or MCP servers. Research and add to the spec:

- MCP servers that should be installed to help the agent with the verification

- helper scripts that need to be generated in the first phases of the plan to verify complex scenarios that can't be covered by the tests in the project's test framework(s)

- any sample input artifact(s) that are required for verification. Note if these artifacts can be a) generated by the agent; b) discovered by the agent on line; c) must be provided by the user.
```

Save the spec to `c:\Users\Al Baraa\Desktop\Github Project\AUTOHIVE\.zencoder\chats\31954dcd-8b42-46b5-ba00-fe700c1e66f8/spec.md`.

### [x] Step: Implementation Plan

Based on the technical spec in `c:\Users\Al Baraa\Desktop\Github Project\AUTOHIVE\.zencoder\chats\31954dcd-8b42-46b5-ba00-fe700c1e66f8/spec.md`, create a detailed task plan and update `c:\Users\Al Baraa\Desktop\Github Project\AUTOHIVE\.zencoder\chats\31954dcd-8b42-46b5-ba00-fe700c1e66f8/plan.md`. Each task should have task definition, references to contracts to be used/implemented, deliverable definition and verification instructions.

---

## Implementation Tasks

### [x] Step: Refactor ModernHomeScreen to use CustomScrollView with SliverAppBar

**Task Instructions**:

Refactor `client/lib/presentation/screens/shared/modern_home_screen.dart` to use CustomScrollView architecture instead of Column + ListView.

**What to do**:
1. Wrap the entire body content with `RefreshIndicator` → `CustomScrollView`
2. Convert the header (created by `_buildHeader()`) into a `SliverAppBar` with `floating: true, pinned: true`
3. Convert the apartments list (`_buildApartmentsList()`) from `ListView.builder` to `SliverList.builder`
4. Ensure all animations, filters, and search functionality work identically
5. Maintain dark/light theme support throughout

**Contracts Used**:
- Existing Apartment model (no changes)
- Existing ApiService for data loading
- Existing _applyFilters() logic unchanged
- Existing animation controllers

**Deliverable**:
- Modified `modern_home_screen.dart` using CustomScrollView and SliverAppBar
- Search bar and filter dropdowns stick to top while scrolling
- Apartment cards render within SliverList
- All existing functionality preserved (filter, search, navigation, theme)

**Verification Instructions**:
1. Run `flutter analyze` - should have no errors/warnings
2. Run `flutter run` to launch the app
3. **Manual Test**: Scroll apartment list - verify search bar + filters stay at top
4. **Manual Test**: Type in search, verify filtering works in real-time
5. **Manual Test**: Change location/price filters, verify results update
6. **Manual Test**: Verify header animations play smoothly
7. **Manual Test**: Toggle dark/light mode, verify styling is consistent
8. **Manual Test**: Click apartment card, verify navigation works
9. **Manual Test**: Pull to refresh, verify apartments reload
10. **Manual Test**: Test with empty results (filter that returns nothing)

**References**:
- See spec.md Phase 1 for architecture details
- Current file: `client/lib/presentation/screens/shared/modern_home_screen.dart` (lines 134-156 for current structure)

---

### [x] Step: Run Flutter Analyzer and Fix Any Issues

**Task Instructions**:

Run Flutter analyzer to ensure no lint errors in the refactored code.

**What to do**:
1. Run `flutter analyze` in the client directory
2. Fix any lint errors or warnings that appear
3. Verify no compilation errors

**Deliverable**:
- Clean `flutter analyze` output with no errors

**Verification Instructions**:
```bash
cd client
flutter analyze
```
Expected output: "No issues found!"

---

### [x] Step: Complete Full Manual Testing

**Fixed**: RenderFlex overflow issue - adjusted expandedHeight to 270 and optimized margins/padding

### [ ] Step: Final Verification

**Task Instructions**:

Run comprehensive manual testing of the sliver-based home page against the test checklist.

**Verification Checklist**:
- [ ] **Header Stickiness**: Load page → scroll → header stays visible
- [ ] **Search Filter**: Type in search → results update in real-time
- [ ] **Location Filter**: Select location → apartments update
- [ ] **Price Filter**: Select price range → apartments update  
- [ ] **Combined Filters**: Apply multiple filters → correct results
- [ ] **Clear Filters**: Reset filters → all apartments show
- [ ] **Animations**: Header entrance animation is smooth
- [ ] **Navigation**: Click apartment → goes to details screen
- [ ] **Owner Profile**: Click owner avatar → info dialog shows
- [ ] **Dark Mode**: Toggle theme → colors update correctly
- [ ] **Light Mode**: Toggle back → styling consistent
- [ ] **Empty Results**: Filter with no matches → "No apartments found" shows
- [ ] **Loading State**: Initial load → spinner displays
- [ ] **Pull to Refresh**: Drag down → apartments reload
- [ ] **Scroll Performance**: Scroll through 50+ apartments → no jank

**Deliverable**:
- All test cases pass
- No visual glitches or performance issues

---

Format each task as

```
### [ ] Step: <task_name>
Task instructions
```
